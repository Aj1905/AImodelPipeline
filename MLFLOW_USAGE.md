# MLflowçµ±åˆæ©Ÿæ¢°å­¦ç¿’ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€æ©Ÿæ¢°å­¦ç¿’ã®å®Ÿé¨“çµæœã‚’MLflowã§è¿½è·¡ãƒ»ç®¡ç†ã§ãã¾ã™ã€‚

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### 1. å­¦ç¿’ã®å®Ÿè¡Œ

```bash
# åŸºæœ¬çš„ãªä½¿ç”¨æ–¹æ³•ï¼ˆMLflowæœ‰åŠ¹ï¼‰
./run_training.sh

# ã¾ãŸã¯ç›´æ¥å®Ÿè¡Œ
source .venv/bin/activate
python src/scripts/07_concise_draftmodel.py
```

### 2. MLflow UIã§çµæœã‚’ç¢ºèª

```bash
# ãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨
./start_mlflow_ui.sh

# ã¾ãŸã¯ç›´æ¥å®Ÿè¡Œ
source .venv/bin/activate
python -m mlflow ui
```

ãã®å¾Œã€ãƒ–ãƒ©ã‚¦ã‚¶ã§ `http://localhost:5000` ã«ã‚¢ã‚¯ã‚»ã‚¹

## ğŸ“Š MLflowã«è¨˜éŒ²ã•ã‚Œã‚‹æƒ…å ±

### ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
- ãƒ†ãƒ¼ãƒ–ãƒ«å
- ã‚¿ãƒ¼ã‚²ãƒƒãƒˆåˆ—
- ç‰¹å¾´é‡æ•°
- ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚º
- åˆ†å‰²æ–¹æ³•ï¼ˆæ™‚ç³»åˆ—/ãƒ©ãƒ³ãƒ€ãƒ ï¼‰
- ãƒ¢ãƒ‡ãƒ«è¨­å®šï¼ˆLightGBMï¼‰

### ãƒ¡ãƒˆãƒªã‚¯ã‚¹
- å­¦ç¿’ãƒ»ãƒ†ã‚¹ãƒˆã®RMSE
- å­¦ç¿’ãƒ»ãƒ†ã‚¹ãƒˆã®RÂ²
- å­¦ç¿’ãƒ»ãƒ†ã‚¹ãƒˆã®MAE
- ç‰¹å¾´é‡é‡è¦åº¦ï¼ˆä¸Šä½10å€‹ï¼‰

### ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆ
- å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ.pklï¼‰
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ.jsonï¼‰

### ã‚¿ã‚°
- å­¦ç¿’æ™‚ã®ã‚³ãƒ¡ãƒ³ãƒˆ

## ğŸ”§ ã‚ªãƒ—ã‚·ãƒ§ãƒ³

### åŸºæœ¬çš„ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³
```bash
# MLflowã‚’ç„¡åŠ¹ã«ã™ã‚‹
./run_training.sh --no-mlflow

# ã‚«ã‚¹ã‚¿ãƒ å®Ÿé¨“åã‚’æŒ‡å®š
./run_training.sh --experiment-name "my_experiment"

# ã‚«ã‚¹ã‚¿ãƒ å®Ÿè¡Œåã‚’æŒ‡å®š
./run_training.sh --run-name "experiment_001"

# æ™‚ç³»åˆ—åˆ†å‰²ã‚’ä½¿ç”¨
./run_training.sh --time-series-split

# ãƒ¢ãƒ‡ãƒ«ã‚’ä¿å­˜ã—ãªã„
./run_training.sh --no-save
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–¢é€£
```bash
# ã‚«ã‚¹ã‚¿ãƒ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ‘ã‚¹
./run_training.sh --db-path "path/to/database.sqlite"

# ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’æŒ‡å®š
./run_training.sh --table "my_table"

# ã‚¿ãƒ¼ã‚²ãƒƒãƒˆåˆ—ã‚’æŒ‡å®š
./run_training.sh --target-column "target"

# ç‰¹å¾´é‡åˆ—ã‚’æŒ‡å®š
./run_training.sh --feature-columns "feature1" "feature2" "feature3"
```

## ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
AImodelPipeline/
â”œâ”€â”€ src/scripts/07_concise_draftmodel.py  # ãƒ¡ã‚¤ãƒ³å­¦ç¿’ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ run_training.sh                       # å­¦ç¿’å®Ÿè¡Œãƒ˜ãƒ«ãƒ‘ãƒ¼
â”œâ”€â”€ start_mlflow_ui.sh                    # MLflow UIèµ·å‹•ãƒ˜ãƒ«ãƒ‘ãƒ¼
â”œâ”€â”€ mlflow.db                             # MLflowãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
â”œâ”€â”€ mlruns/                               # MLflowå®Ÿè¡Œå±¥æ­´
â””â”€â”€ trained_model/                        # ä¿å­˜ã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ«
```

## ğŸ” MLflow UIã§ã®ç¢ºèªæ–¹æ³•

1. `./start_mlflow_ui.sh` ã‚’å®Ÿè¡Œ
2. ãƒ–ãƒ©ã‚¦ã‚¶ã§ `http://localhost:5000` ã«ã‚¢ã‚¯ã‚»ã‚¹
3. å®Ÿé¨“ä¸€è¦§ã‹ã‚‰è©²å½“ã™ã‚‹å®Ÿé¨“ã‚’é¸æŠ
4. å®Ÿè¡Œå±¥æ­´ã‹ã‚‰è©³ç´°ãªçµæœã‚’ç¢ºèª

### ç¢ºèªã§ãã‚‹æƒ…å ±
- ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ¯”è¼ƒ
- ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®æ¨ç§»
- ç‰¹å¾´é‡é‡è¦åº¦
- ä¿å­˜ã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«
- å­¦ç¿’æ™‚ã®ã‚³ãƒ¡ãƒ³ãƒˆ

## ğŸ› ï¸ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ä»®æƒ³ç’°å¢ƒã®å•é¡Œ
```bash
# ä»®æƒ³ç’°å¢ƒã‚’æœ‰åŠ¹åŒ–
source .venv/bin/activate

# ä¾å­˜é–¢ä¿‚ã‚’ç¢ºèª
pip list | grep mlflow
```

### MLflow UIãŒèµ·å‹•ã—ãªã„å ´åˆ
```bash
# ãƒãƒ¼ãƒˆãŒä½¿ç”¨ä¸­ã®å ´åˆã€åˆ¥ã®ãƒãƒ¼ãƒˆã‚’æŒ‡å®š
python -m mlflow ui --port 5001
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆ
```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ç¢ºèª
ls -la data/database.sqlite
```

## ğŸ“ ä¾‹

### åŸºæœ¬çš„ãªå­¦ç¿’å®Ÿè¡Œ
```bash
./run_training.sh
```

### ã‚«ã‚¹ã‚¿ãƒ è¨­å®šã§ã®å­¦ç¿’
```bash
./run_training.sh \
  --experiment-name "restaurant_forecast" \
  --run-name "v1_lightgbm" \
  --time-series-split \
  --table "sales_data" \
  --target-column "sales" \
  --feature-columns "temperature" "humidity" "day_of_week"
```

### çµæœã®ç¢ºèª
```bash
./start_mlflow_ui.sh
# ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:5000 ã«ã‚¢ã‚¯ã‚»ã‚¹
``` 